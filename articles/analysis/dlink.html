<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <title>D-Link(通信規格)</title>
    <link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico">
    <link rel="stylesheet" type="text/css" href="../../styles/style.css">
    <script>pagetype="analysis";path="../";</script>
    <script src="../../scripts/script.js"></script>
  </head>
  <body>
    <div class="wrapper">
      <div class="content">
	<div>
	  <h1>D-Link(通信規格)まとめ</h1>
	  <br>
	  <span class="date">記事作成 : 2016/4/27(水)</span>
	  <span class="date">最終更新 : 2016/11/22(火)</span>
	  <hr>
	  <!-------------------- 記事内容 -------------------->
	  <h3>はじめに</h3>
	  <p>
	    <b>D-Link</b> とは携帯液晶ゲーム「デジタルモンスター」の通信に使用されている通信規格のことです。
	    このD-Linkという名称はD-3が発売されたころに使われていたそうですが(wiki参照)、一般的に普及していたかはかなり怪しいところです。
	    せっかく名付けられたのですから当サイトではD-Linkという名称を使うことにします。
	  </p>
	  <p>
	    D-Linkは初代からペンデュラムプログレスまで使用されましたが、ペンデュラム以降はバトル形式の変化に伴ってデータ形式も変更されています。
	    ここではD-Linkが使用されている全ての液晶ゲーム(デジヴァイスも含む)で共通する部分のみを解説したいと思います。
	  </p>
	  <p>
	    ちなみにここに書いている内容は私が解析した結果から推測したものであり、正しいという保障はありませんのであしからず。
	  </p>
	  <br>
	  <h3>コネクタ</h3>
	  <p>
	    コネクタはご存知の通り2端子です。
	    下の写真のように、正面から見て奥の端子がGNDとなっており、手前の端子でデータの送受信を行います。
	  </p>
	  <img src="dlink/connector.jpg" width="300px">
	  <p>
	    信号線は平常時はHi-Z出力でプルアップされた状態となっています。
	    データ送信時はHighとLowが出力されます(Hi-Zではないことに注意してください)。
	    なお、Highレベルの電圧は電源(LR44×2)の電圧なので3Vです。
	  </p>
	  <br>
	  <h3>フレーム</h3>
	  <p>
	    D-Linkはフレーム単位で通信を行います。
	    フレームのデータサイズは16bitで、このフレームを交互に送信するかたちで通信が行われます。
	    データ内容および1度の通信で送信されるフレーム数は液晶ゲームの種類によって異なります。
	    例えば、初代デジタルモンスターで送受信されるフレームは合計4つですが、ペンデュラムでは6つとなっています。
	  </p>
	  <p>
	    フレームのフォーマットは下の図のように、3種類のパルスから構成されます。
	  </p>
	  <img src="dlink/frame.png" width="600px" height="180px">
	  <br><br>
	  <h4>【Startパルス】</h4>
	  <p>
	    フレームの最初は60msのLowが送信されます。
	    このパルスの長さは何秒まででも良いらしく、ずっとLowを送信し続けると受信側はいつまでもフレームを待ち続けるようです。
	  </p>
	  <img src="dlink/start-pulse.png">
	  <br>
	  <h4>【Headパルス】</h4>
	  <p>
	    Startパルスの直後にはデータとは関係の無いパルスが1つ送信されます。
	    波形は下の図のように、Highの時間が2ms、Lowの時間が1msで固定です。
	  </p>
	  <img src="dlink/head-pulse.png">
	  <br>
	  <h4>【Dataパルス】</h4>
	  <p>
	    D-LinkではパルスのHighの長さで"0"、"1"の情報を送信します。
	    Highの時間が長ければ"1"、短かければ"0"となり、HighとLowの時間を合計したパルスの長さは必ず4msとなります。
	    フレームのデータサイズは16bitなので、このデータパルスが16個連続して送信されます。
	    また、データはLSB(最下位ビット)から順に送信されます。
	  </p>
	  <img src="dlink/data-pulse.png">
	  <!-------------------- ここまで -------------------->
	  <hr>
	</div>
      </div>
    </div>
  </body>
</html>
